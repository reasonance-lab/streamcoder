import streamlit as st
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from datetime import datetime, timedelta
import plotly.graph_objects as go
from plotly.subplots import make_subplots

# Generate fictitious stock prices
start_date = datetime(2023, 1, 1)
dates = [start_date + timedelta(days=i) for i in range(90)]

np.random.seed(42)
microsoft_prices = np.random.normal(loc=250, scale=10, size=90).cumsum() + 250
apple_prices = np.random.normal(loc=150, scale=5, size=90).cumsum() + 150

# Create DataFrame
df = pd.DataFrame({
    'Date': dates,
    'Microsoft': microsoft_prices,
    'Apple': apple_prices
})

st.title('Stock Price Visualization')

# Plot 1: Line plot using Matplotlib
st.subheader('Line Plot: Microsoft vs Apple')
fig, ax = plt.subplots(figsize=(12, 6))
ax.plot(df['Date'], df['Microsoft'], label='Microsoft')
ax.plot(df['Date'], df['Apple'], label='Apple')
ax.set_title('Stock Prices: Microsoft vs Apple')
ax.set_xlabel('Date')
ax.set_ylabel('Price')
ax.legend()
st.pyplot(fig)

# Plot 2: Candlestick chart using Plotly
st.subheader('Candlestick Chart: Microsoft and Apple')
fig = make_subplots(rows=1, cols=2, shared_xaxes=True, subplot_titles=('Microsoft', 'Apple'))

for i, company in enumerate(['Microsoft', 'Apple'], 1):
    fig.add_trace(go.Candlestick(
        x=df['Date'],
        open=df[company],
        high=df[company] + np.random.uniform(0, 5, 90),
        low=df[company] - np.random.uniform(0, 5, 90),
        close=df[company],
        name=company
    ), row=1, col=i)

fig.update_layout(title_text='Stock Prices: Candlestick Chart', height=600)
st.plotly_chart(fig)

# Plot 3: Area chart using Plotly
st.subheader('Area Chart: Microsoft and Apple')
fig = go.Figure()
fig.add_trace(go.Scatter(x=df['Date'], y=df['Microsoft'], fill='tozeroy', name='Microsoft'))
fig.add_trace(go.Scatter(x=df['Date'], y=df['Apple'], fill='tozeroy', name='Apple'))
fig.update_layout(title='Stock Prices: Area Chart', xaxis_title='Date', yaxis_title='Price')
st.plotly_chart(fig)