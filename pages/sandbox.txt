import streamlit as st
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

# Generate sample data
def generate_sample_data():
    np.random.seed(42)
    dates = pd.date_range(start='2023-01-01', end='2023-12-31', freq='D')
    sales = np.random.randint(100, 1000, size=len(dates))
    products = np.random.choice(['A', 'B', 'C'], size=len(dates))
    return pd.DataFrame({'Date': dates, 'Sales': sales, 'Product': products})

# Perform data analysis
def analyze_data(df):
    total_sales = df['Sales'].sum()
    avg_sales = df['Sales'].mean()
    product_sales = df.groupby('Product')['Sales'].sum()
    monthly_sales = df.resample('M', on='Date')['Sales'].sum()
    return total_sales, avg_sales, product_sales, monthly_sales

# Create charts
def create_charts(product_sales, monthly_sales):
    # Product Sales Bar Chart
    fig1, ax1 = plt.subplots()
    product_sales.plot(kind='bar', ax=ax1)
    ax1.set_title('Total Sales by Product')
    ax1.set_xlabel('Product')
    ax1.set_ylabel('Total Sales')

    # Monthly Sales Line Chart
    fig2, ax2 = plt.subplots()
    monthly_sales.plot(kind='line', ax=ax2)
    ax2.set_title('Monthly Sales Trend')
    ax2.set_xlabel('Month')
    ax2.set_ylabel('Total Sales')

    return fig1, fig2

# Streamlit app
st.title('Sample Data Analysis Dashboard')

# Generate and display sample data
data = generate_sample_data()
st.subheader('Sample Data')
st.dataframe(data)

# Perform data analysis
total_sales, avg_sales, product_sales, monthly_sales = analyze_data(data)

# Display analysis results
st.subheader('Data Analysis Results')
col1, col2 = st.columns(2)
col1.metric('Total Sales', f'${total_sales:,.0f}')
col2.metric('Average Daily Sales', f'${avg_sales:.2f}')

# Create and display charts
fig1, fig2 = create_charts(product_sales, monthly_sales)

st.subheader('Sales Charts')
st.pyplot(fig1)
st.pyplot(fig2)